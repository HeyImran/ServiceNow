Table: CTSK (sc_task)

BR: After Update BR

(function executeRule(current, previous /*null when async*/ ) {

    // Add your code here
    if (current.state.changesTo(3)) {
        var cTask = new GlideRecord('sc_task');
        cTask.addQuery('request_item', current.request_item);
        cTask.addQuery('state', '!=', 3);
        cTask.query();
        if (parseInt(cTask.getRowCount(),10) === 0) {
            var ritmGR = new GlideRecord('sc_req_item');
            if (ritmGR.get(current.request_item)) {
                ritmGR.state = 3;
                ritmGR.work_notes = "Copied from child: " + current.number + '\n>>>' + current.work_notes.getJournalEntry(1);
                ritmGR.update();

            }
        }
    }

})(current, previous);
